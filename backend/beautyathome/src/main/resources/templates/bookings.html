<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>BeautyAtHome · Reservas</title>
    <link rel="stylesheet" th:href="@{/css/app.css}" href="/css/app.css" />
</head>
<body class="app-body">
<div class="shell">
    <header class="top-nav">
        <div class="brand">
            <span class="brand__glyph">BAH</span>
            <div>
                <p class="brand__title">BeautyAtHome</p>
                <small class="brand__tagline">Agenda viva</small>
            </div>
        </div>
        <nav class="nav-links">
            <a th:href="@{/home}">Inicio</a>
            <a th:href="@{/clients}">Clientes</a>
            <a th:href="@{/professionals}">Profesionales</a>
            <a th:href="@{/bookings}" class="is-active">Reservas</a>
            <a th:href="@{/reviews}">Reseñas</a>
        </nav>
    </header>

    <main class="content">
        <section class="hero hero--sub">
            <div>
                <p class="eyebrow">Orquestación</p>
                <h1>Coordina clientes, profesionales y servicios en segundos</h1>
                <p>Ingresa IDs existentes para disparar el flujo Command + Observer de la agenda.</p>
            </div>
            <div class="hero__badge">
                <p class="hero__kpi" th:text="${#lists.size(bookings)}">0</p>
                <p class="hero__label">Reservas creadas</p>
                <span>Estado en vivo</span>
            </div>
        </section>

        <section class="glass-panel">
            <div class="section-header">
                <h2>Nueva reserva</h2>
                <p>Usa formato ISO para la fecha (ej. 2025-12-07T10:00).</p>
            </div>
            <div th:if="${message}" class="alert alert-success" th:text="${message}"></div>
            <div th:if="${error}" class="alert alert-error" th:text="${error}"></div>
            <form th:action="@{/bookings}" th:object="${bookingForm}" method="post" class="form-grid two">
                <label>Cliente<input type="text" th:field="*{clientId}" placeholder="cli-001" required /></label>
                <label>Profesional<input type="text" th:field="*{professionalId}" placeholder="pro-001" required /></label>
                <label>Servicio<input type="text" th:field="*{serviceId}" placeholder="Corte deluxe" required /></label>
                <label>Zona<input type="text" th:field="*{zone}" placeholder="Chapinero" /></label>
                <label class="grid-span">Fecha y hora<input type="text" th:field="*{dateTime}" placeholder="2025-12-07T10:00" required /></label>
                <button type="submit" class="btn primary">Reservar</button>
            </form>
        </section>

        <section class="glass-panel">
            <div class="section-header">
                <div>
                    <h2>Tablero de estados</h2>
                    <p>Visualiza el ciclo completo: pendientes, completadas y canceladas.</p>
                </div>
                <span th:text="${#lists.size(bookings)} + ' reservas activas'">0 reservas activas</span>
            </div>
            <div class="card-grid three booking-lanes">
                <article class="booking-lane" th:each="lane : ${bookingLanes}">
                    <div class="booking-lane__head">
                        <div>
                            <p class="eyebrow" th:text="${lane.title}">Pendientes</p>
                            <p class="muted" th:text="${lane.description}">Descripción</p>
                        </div>
                        <span class="badge" th:classappend="' ' + lane.badgeTone" th:text="${lane.cards.size()} + ' en cola'">0 en cola</span>
                    </div>
                    <ul class="timeline">
                        <li class="timeline__item"
                            th:classappend="' ' + card.timelineModifier"
                            th:each="card : ${lane.cards}">
                            <span class="timeline__time" th:text="${#temporals.format(card.booking.dateTime, 'dd MMM HH:mm')}">07 Dic 10:00</span>
                            <div>
                                <p class="timeline__title" th:text="${card.booking.serviceId}">Servicio</p>
                                <p class="timeline__meta">
                                    <span th:text="${card.booking.clientId}">Cliente</span>
                                    ·
                                    <span th:text="${card.booking.professionalId}">Profesional</span>
                                </p>
                                <small th:text="${card.booking.id}">booking-id</small>
                            </div>
                            <span class="badge" th:classappend="' ' + card.statusTone" th:text="${card.statusLabel}">Estado</span>
                        </li>
                        <li class="timeline__item empty" th:if="${#lists.isEmpty(lane.cards)}" th:text="${lane.emptyLabel}">
                            Sin actividad
                        </li>
                    </ul>
                </article>
            </div>
        </section>
    </main>
</div>
</body>
</html>
